{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AES_GCM_SealedBox = void 0;\nconst neverthrow_1 = require(\"neverthrow\");\nconst util_1 = require(\"@radixdlt/util\");\nconst utils_1 = require(\"../../utils\");\nconst tagLength = 16;\nconst nonceLength = 12;\nconst cipherMinLength = 1;\nconst __validateNonce = utils_1.validateLength.bind(null, nonceLength, 'nonce (IV)');\nconst __validateTag = utils_1.validateLength.bind(null, tagLength, 'auth tag');\nconst __validateAESSealedBoxCiphertext = utils_1.validateMinLength.bind(null, cipherMinLength, 'ciphertext');\n/*\n * returns combined buffers: `nonce || tag || cipher`\n * */\nconst combineSealedBoxProps = input => Buffer.concat([input.nonce, input.authTag, input.ciphertext]);\nconst create = input => (0, neverthrow_1.combine)([__validateNonce(input.nonce), __validateTag(input.authTag), __validateAESSealedBoxCiphertext(input.ciphertext)]).map(_ => Object.assign(Object.assign({}, input), {\n  combined: () => combineSealedBoxProps(input),\n  equals: other => (0, util_1.buffersEquals)(other.nonce, input.nonce) && (0, util_1.buffersEquals)(other.authTag, input.authTag) && (0, util_1.buffersEquals)(other.ciphertext, input.ciphertext)\n}));\n/* Buffer is: `nonce || tag || cipher` */\nconst aesSealedBoxFromBuffer = buffer => {\n  const readNextBuffer = util_1.readBuffer.bind(null, buffer)();\n  return (0, neverthrow_1.combine)([readNextBuffer(nonceLength), readNextBuffer(tagLength), readNextBuffer(buffer.length - nonceLength - tagLength)]).map(parsed => {\n    const nonce = parsed[0];\n    const authTag = parsed[1];\n    const ciphertext = parsed[2];\n    return {\n      nonce,\n      authTag,\n      ciphertext\n    };\n  }).andThen(create);\n};\nexports.AES_GCM_SealedBox = {\n  fromCombinedBuffer: aesSealedBoxFromBuffer,\n  create,\n  nonceLength,\n  tagLength\n};","map":{"version":3,"names":["neverthrow_1","require","util_1","utils_1","tagLength","nonceLength","cipherMinLength","__validateNonce","validateLength","bind","__validateTag","__validateAESSealedBoxCiphertext","validateMinLength","combineSealedBoxProps","input","Buffer","concat","nonce","authTag","ciphertext","create","combine","map","_","Object","assign","combined","equals","other","buffersEquals","aesSealedBoxFromBuffer","buffer","readNextBuffer","readBuffer","length","parsed","andThen","exports","AES_GCM_SealedBox","fromCombinedBuffer"],"sources":["../../../src/symmetric-encryption/aes/aesGCMSealedBox.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,MAAAA,YAAA,GAAAC,OAAA;AAEA,MAAAC,MAAA,GAAAD,OAAA;AACA,MAAAE,OAAA,GAAAF,OAAA;AAEA,MAAMG,SAAS,GAAG,EAAE;AACpB,MAAMC,WAAW,GAAG,EAAE;AAEtB,MAAMC,eAAe,GAAG,CAAC;AAEzB,MAAMC,eAAe,GAEQJ,OAAA,CAAAK,cAAc,CAACC,IAAI,CAC/C,IAAI,EACJJ,WAAW,EACX,YAAY,CACZ;AAED,MAAMK,aAAa,GAEUP,OAAA,CAAAK,cAAc,CAACC,IAAI,CAAC,IAAI,EAAEL,SAAS,EAAE,UAAU,CAAC;AAE7E,MAAMO,gCAAgC,GAETR,OAAA,CAAAS,iBAAiB,CAACH,IAAI,CAClD,IAAI,EACJH,eAAe,EACf,YAAY,CACZ;AAED;;;AAGA,MAAMO,qBAAqB,GAAIC,KAA6B,IAC3DC,MAAM,CAACC,MAAM,CAAC,CAACF,KAAK,CAACG,KAAK,EAAEH,KAAK,CAACI,OAAO,EAAEJ,KAAK,CAACK,UAAU,CAAC,CAAC;AAE9D,MAAMC,MAAM,GACXN,KAA6B,IAE7B,IAAAd,YAAA,CAAAqB,OAAO,EAAC,CACPd,eAAe,CAACO,KAAK,CAACG,KAAK,CAAC,EAC5BP,aAAa,CAACI,KAAK,CAACI,OAAO,CAAC,EAC5BP,gCAAgC,CAACG,KAAK,CAACK,UAAU,CAAC,CAClD,CAAC,CAACG,GAAG,CAACC,CAAC,IAAIC,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACRX,KAAK;EACRY,QAAQ,EAAEA,CAAA,KAAcb,qBAAqB,CAACC,KAAK,CAAC;EACpDa,MAAM,EAAGC,KAAyB,IACjC,IAAA1B,MAAA,CAAA2B,aAAa,EAACD,KAAK,CAACX,KAAK,EAAEH,KAAK,CAACG,KAAK,CAAC,IACvC,IAAAf,MAAA,CAAA2B,aAAa,EAACD,KAAK,CAACV,OAAO,EAAEJ,KAAK,CAACI,OAAO,CAAC,IAC3C,IAAAhB,MAAA,CAAA2B,aAAa,EAACD,KAAK,CAACT,UAAU,EAAEL,KAAK,CAACK,UAAU;AAAC,EACjD,CAAC;AAEJ;AACA,MAAMW,sBAAsB,GAC3BC,MAAc,IACwB;EACtC,MAAMC,cAAc,GAAG9B,MAAA,CAAA+B,UAAU,CAACxB,IAAI,CAAC,IAAI,EAAEsB,MAAM,CAAC,EAAE;EACtD,OAAO,IAAA/B,YAAA,CAAAqB,OAAO,EAAC,CACdW,cAAc,CAAC3B,WAAW,CAAC,EAC3B2B,cAAc,CAAC5B,SAAS,CAAC,EACzB4B,cAAc,CAACD,MAAM,CAACG,MAAM,GAAG7B,WAAW,GAAGD,SAAS,CAAC,CACvD,CAAC,CACAkB,GAAG,CAAEa,MAAgB,IAAI;IACzB,MAAMlB,KAAK,GAAGkB,MAAM,CAAC,CAAC,CAAC;IACvB,MAAMjB,OAAO,GAAGiB,MAAM,CAAC,CAAC,CAAC;IACzB,MAAMhB,UAAU,GAAGgB,MAAM,CAAC,CAAC,CAAC;IAE5B,OAAO;MACNlB,KAAK;MACLC,OAAO;MACPC;KACA;EACF,CAAC,CAAC,CACDiB,OAAO,CAAChB,MAAM,CAAC;AAClB,CAAC;AAEYiB,OAAA,CAAAC,iBAAiB,GAAG;EAChCC,kBAAkB,EAAET,sBAAsB;EAC1CV,MAAM;EACNf,WAAW;EACXD;CACA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}