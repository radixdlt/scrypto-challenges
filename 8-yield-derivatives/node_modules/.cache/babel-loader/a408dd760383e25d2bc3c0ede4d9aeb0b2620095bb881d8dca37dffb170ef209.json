{"ast":null,"code":"'use strict';\n\nvar BN = require('bn.js');\nvar utils = require('../utils');\nvar assert = utils.assert;\nfunction KeyPair(ec, options) {\n  this.ec = ec;\n  this.priv = null;\n  this.pub = null;\n\n  // KeyPair(ec, { priv: ..., pub: ... })\n  if (options.priv) this._importPrivate(options.priv, options.privEnc);\n  if (options.pub) this._importPublic(options.pub, options.pubEnc);\n}\nmodule.exports = KeyPair;\nKeyPair.fromPublic = function fromPublic(ec, pub, enc) {\n  if (pub instanceof KeyPair) return pub;\n  return new KeyPair(ec, {\n    pub: pub,\n    pubEnc: enc\n  });\n};\nKeyPair.fromPrivate = function fromPrivate(ec, priv, enc) {\n  if (priv instanceof KeyPair) return priv;\n  return new KeyPair(ec, {\n    priv: priv,\n    privEnc: enc\n  });\n};\nKeyPair.prototype.validate = function validate() {\n  var pub = this.getPublic();\n  if (pub.isInfinity()) return {\n    result: false,\n    reason: 'Invalid public key'\n  };\n  if (!pub.validate()) return {\n    result: false,\n    reason: 'Public key is not a point'\n  };\n  if (!pub.mul(this.ec.curve.n).isInfinity()) return {\n    result: false,\n    reason: 'Public key * N != O'\n  };\n  return {\n    result: true,\n    reason: null\n  };\n};\nKeyPair.prototype.getPublic = function getPublic(compact, enc) {\n  // compact is optional argument\n  if (typeof compact === 'string') {\n    enc = compact;\n    compact = null;\n  }\n  if (!this.pub) this.pub = this.ec.g.mul(this.priv);\n  if (!enc) return this.pub;\n  return this.pub.encode(enc, compact);\n};\nKeyPair.prototype.getPrivate = function getPrivate(enc) {\n  if (enc === 'hex') return this.priv.toString(16, 2);else return this.priv;\n};\nKeyPair.prototype._importPrivate = function _importPrivate(key, enc) {\n  this.priv = new BN(key, enc || 16);\n\n  // Ensure that the priv won't be bigger than n, otherwise we may fail\n  // in fixed multiplication method\n  this.priv = this.priv.umod(this.ec.curve.n);\n};\nKeyPair.prototype._importPublic = function _importPublic(key, enc) {\n  if (key.x || key.y) {\n    // Montgomery points only have an `x` coordinate.\n    // Weierstrass/Edwards points on the other hand have both `x` and\n    // `y` coordinates.\n    if (this.ec.curve.type === 'mont') {\n      assert(key.x, 'Need x coordinate');\n    } else if (this.ec.curve.type === 'short' || this.ec.curve.type === 'edwards') {\n      assert(key.x && key.y, 'Need both x and y coordinate');\n    }\n    this.pub = this.ec.curve.point(key.x, key.y);\n    return;\n  }\n  this.pub = this.ec.curve.decodePoint(key, enc);\n};\n\n// ECDH\nKeyPair.prototype.derive = function derive(pub) {\n  if (!pub.validate()) {\n    assert(pub.validate(), 'public point not validated');\n  }\n  return pub.mul(this.priv).getX();\n};\n\n// ECDSA\nKeyPair.prototype.sign = function sign(msg, enc, options) {\n  return this.ec.sign(msg, this, enc, options);\n};\nKeyPair.prototype.verify = function verify(msg, signature) {\n  return this.ec.verify(msg, signature, this);\n};\nKeyPair.prototype.inspect = function inspect() {\n  return '<Key priv: ' + (this.priv && this.priv.toString(16, 2)) + ' pub: ' + (this.pub && this.pub.inspect()) + ' >';\n};","map":{"version":3,"names":["BN","require","utils","assert","KeyPair","ec","options","priv","pub","_importPrivate","privEnc","_importPublic","pubEnc","module","exports","fromPublic","enc","fromPrivate","prototype","validate","getPublic","isInfinity","result","reason","mul","curve","n","compact","g","encode","getPrivate","toString","key","umod","x","y","type","point","decodePoint","derive","getX","sign","msg","verify","signature","inspect"],"sources":["/Users/mdabdurrazzak/RadInsu/node_modules/elliptic/lib/elliptic/ec/key.js"],"sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\nvar utils = require('../utils');\nvar assert = utils.assert;\n\nfunction KeyPair(ec, options) {\n  this.ec = ec;\n  this.priv = null;\n  this.pub = null;\n\n  // KeyPair(ec, { priv: ..., pub: ... })\n  if (options.priv)\n    this._importPrivate(options.priv, options.privEnc);\n  if (options.pub)\n    this._importPublic(options.pub, options.pubEnc);\n}\nmodule.exports = KeyPair;\n\nKeyPair.fromPublic = function fromPublic(ec, pub, enc) {\n  if (pub instanceof KeyPair)\n    return pub;\n\n  return new KeyPair(ec, {\n    pub: pub,\n    pubEnc: enc,\n  });\n};\n\nKeyPair.fromPrivate = function fromPrivate(ec, priv, enc) {\n  if (priv instanceof KeyPair)\n    return priv;\n\n  return new KeyPair(ec, {\n    priv: priv,\n    privEnc: enc,\n  });\n};\n\nKeyPair.prototype.validate = function validate() {\n  var pub = this.getPublic();\n\n  if (pub.isInfinity())\n    return { result: false, reason: 'Invalid public key' };\n  if (!pub.validate())\n    return { result: false, reason: 'Public key is not a point' };\n  if (!pub.mul(this.ec.curve.n).isInfinity())\n    return { result: false, reason: 'Public key * N != O' };\n\n  return { result: true, reason: null };\n};\n\nKeyPair.prototype.getPublic = function getPublic(compact, enc) {\n  // compact is optional argument\n  if (typeof compact === 'string') {\n    enc = compact;\n    compact = null;\n  }\n\n  if (!this.pub)\n    this.pub = this.ec.g.mul(this.priv);\n\n  if (!enc)\n    return this.pub;\n\n  return this.pub.encode(enc, compact);\n};\n\nKeyPair.prototype.getPrivate = function getPrivate(enc) {\n  if (enc === 'hex')\n    return this.priv.toString(16, 2);\n  else\n    return this.priv;\n};\n\nKeyPair.prototype._importPrivate = function _importPrivate(key, enc) {\n  this.priv = new BN(key, enc || 16);\n\n  // Ensure that the priv won't be bigger than n, otherwise we may fail\n  // in fixed multiplication method\n  this.priv = this.priv.umod(this.ec.curve.n);\n};\n\nKeyPair.prototype._importPublic = function _importPublic(key, enc) {\n  if (key.x || key.y) {\n    // Montgomery points only have an `x` coordinate.\n    // Weierstrass/Edwards points on the other hand have both `x` and\n    // `y` coordinates.\n    if (this.ec.curve.type === 'mont') {\n      assert(key.x, 'Need x coordinate');\n    } else if (this.ec.curve.type === 'short' ||\n               this.ec.curve.type === 'edwards') {\n      assert(key.x && key.y, 'Need both x and y coordinate');\n    }\n    this.pub = this.ec.curve.point(key.x, key.y);\n    return;\n  }\n  this.pub = this.ec.curve.decodePoint(key, enc);\n};\n\n// ECDH\nKeyPair.prototype.derive = function derive(pub) {\n  if(!pub.validate()) {\n    assert(pub.validate(), 'public point not validated');\n  }\n  return pub.mul(this.priv).getX();\n};\n\n// ECDSA\nKeyPair.prototype.sign = function sign(msg, enc, options) {\n  return this.ec.sign(msg, this, enc, options);\n};\n\nKeyPair.prototype.verify = function verify(msg, signature) {\n  return this.ec.verify(msg, signature, this);\n};\n\nKeyPair.prototype.inspect = function inspect() {\n  return '<Key priv: ' + (this.priv && this.priv.toString(16, 2)) +\n         ' pub: ' + (this.pub && this.pub.inspect()) + ' >';\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}