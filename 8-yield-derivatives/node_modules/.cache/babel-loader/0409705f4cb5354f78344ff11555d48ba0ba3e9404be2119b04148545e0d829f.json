{"ast":null,"code":"function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = {\n      forever: options\n    };\n  }\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\nRetryOperation.prototype.stop = function () {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n  this._timeouts = [];\n  this._cachedTimeouts = null;\n};\nRetryOperation.prototype.retry = function (err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n  if (!err) {\n    return false;\n  }\n  this._errors.push(err);\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(this._errors.length - 1, this._errors.length);\n      this._timeouts = this._cachedTimeouts.slice(0);\n      timeout = this._timeouts.shift();\n    } else {\n      return false;\n    }\n  }\n  var self = this;\n  var timer = setTimeout(function () {\n    self._attempts++;\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function () {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n      if (this._options.unref) {\n        self._timeout.unref();\n      }\n    }\n    self._fn(self._attempts);\n  }, timeout);\n  if (this._options.unref) {\n    timer.unref();\n  }\n  return true;\n};\nRetryOperation.prototype.attempt = function (fn, timeoutOps) {\n  this._fn = fn;\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function () {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n  this._fn(this._attempts);\n};\nRetryOperation.prototype.try = function (fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\nRetryOperation.prototype.start = function (fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\nRetryOperation.prototype.start = RetryOperation.prototype.try;\nRetryOperation.prototype.errors = function () {\n  return this._errors;\n};\nRetryOperation.prototype.attempts = function () {\n  return this._attempts;\n};\nRetryOperation.prototype.mainError = function () {\n  if (this._errors.length === 0) {\n    return null;\n  }\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n    counts[message] = count;\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n  return mainError;\n};","map":{"version":3,"names":["RetryOperation","timeouts","options","forever","_timeouts","_options","_fn","_errors","_attempts","_operationTimeout","_operationTimeoutCb","_timeout","_cachedTimeouts","slice","module","exports","prototype","stop","clearTimeout","retry","err","push","timeout","shift","undefined","splice","length","self","timer","setTimeout","unref","attempt","fn","timeoutOps","cb","try","console","log","start","errors","attempts","mainError","counts","mainErrorCount","i","error","message","count"],"sources":["/Users/mdabdurrazzak/RadInsu/node_modules/promise-retry/node_modules/retry/lib/retry_operation.js"],"sourcesContent":["function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = { forever: options };\n  }\n\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\n\nRetryOperation.prototype.stop = function() {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  this._timeouts       = [];\n  this._cachedTimeouts = null;\n};\n\nRetryOperation.prototype.retry = function(err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  if (!err) {\n    return false;\n  }\n\n  this._errors.push(err);\n\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(this._errors.length - 1, this._errors.length);\n      this._timeouts = this._cachedTimeouts.slice(0);\n      timeout = this._timeouts.shift();\n    } else {\n      return false;\n    }\n  }\n\n  var self = this;\n  var timer = setTimeout(function() {\n    self._attempts++;\n\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function() {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n\n      if (this._options.unref) {\n          self._timeout.unref();\n      }\n    }\n\n    self._fn(self._attempts);\n  }, timeout);\n\n  if (this._options.unref) {\n      timer.unref();\n  }\n\n  return true;\n};\n\nRetryOperation.prototype.attempt = function(fn, timeoutOps) {\n  this._fn = fn;\n\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function() {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n\n  this._fn(this._attempts);\n};\n\nRetryOperation.prototype.try = function(fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = function(fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = RetryOperation.prototype.try;\n\nRetryOperation.prototype.errors = function() {\n  return this._errors;\n};\n\nRetryOperation.prototype.attempts = function() {\n  return this._attempts;\n};\n\nRetryOperation.prototype.mainError = function() {\n  if (this._errors.length === 0) {\n    return null;\n  }\n\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n\n    counts[message] = count;\n\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n\n  return mainError;\n};\n"],"mappings":"AAAA,SAASA,cAAcA,CAACC,QAAQ,EAAEC,OAAO,EAAE;EACzC;EACA,IAAI,OAAOA,OAAO,KAAK,SAAS,EAAE;IAChCA,OAAO,GAAG;MAAEC,OAAO,EAAED;IAAQ,CAAC;EAChC;EAEA,IAAI,CAACE,SAAS,GAAGH,QAAQ;EACzB,IAAI,CAACI,QAAQ,GAAGH,OAAO,IAAI,CAAC,CAAC;EAC7B,IAAI,CAACI,GAAG,GAAG,IAAI;EACf,IAAI,CAACC,OAAO,GAAG,EAAE;EACjB,IAAI,CAACC,SAAS,GAAG,CAAC;EAClB,IAAI,CAACC,iBAAiB,GAAG,IAAI;EAC7B,IAAI,CAACC,mBAAmB,GAAG,IAAI;EAC/B,IAAI,CAACC,QAAQ,GAAG,IAAI;EAEpB,IAAI,IAAI,CAACN,QAAQ,CAACF,OAAO,EAAE;IACzB,IAAI,CAACS,eAAe,GAAG,IAAI,CAACR,SAAS,CAACS,KAAK,CAAC,CAAC,CAAC;EAChD;AACF;AACAC,MAAM,CAACC,OAAO,GAAGf,cAAc;AAE/BA,cAAc,CAACgB,SAAS,CAACC,IAAI,GAAG,YAAW;EACzC,IAAI,IAAI,CAACN,QAAQ,EAAE;IACjBO,YAAY,CAAC,IAAI,CAACP,QAAQ,CAAC;EAC7B;EAEA,IAAI,CAACP,SAAS,GAAS,EAAE;EACzB,IAAI,CAACQ,eAAe,GAAG,IAAI;AAC7B,CAAC;AAEDZ,cAAc,CAACgB,SAAS,CAACG,KAAK,GAAG,UAASC,GAAG,EAAE;EAC7C,IAAI,IAAI,CAACT,QAAQ,EAAE;IACjBO,YAAY,CAAC,IAAI,CAACP,QAAQ,CAAC;EAC7B;EAEA,IAAI,CAACS,GAAG,EAAE;IACR,OAAO,KAAK;EACd;EAEA,IAAI,CAACb,OAAO,CAACc,IAAI,CAACD,GAAG,CAAC;EAEtB,IAAIE,OAAO,GAAG,IAAI,CAAClB,SAAS,CAACmB,KAAK,CAAC,CAAC;EACpC,IAAID,OAAO,KAAKE,SAAS,EAAE;IACzB,IAAI,IAAI,CAACZ,eAAe,EAAE;MACxB;MACA,IAAI,CAACL,OAAO,CAACkB,MAAM,CAAC,IAAI,CAAClB,OAAO,CAACmB,MAAM,GAAG,CAAC,EAAE,IAAI,CAACnB,OAAO,CAACmB,MAAM,CAAC;MACjE,IAAI,CAACtB,SAAS,GAAG,IAAI,CAACQ,eAAe,CAACC,KAAK,CAAC,CAAC,CAAC;MAC9CS,OAAO,GAAG,IAAI,CAAClB,SAAS,CAACmB,KAAK,CAAC,CAAC;IAClC,CAAC,MAAM;MACL,OAAO,KAAK;IACd;EACF;EAEA,IAAII,IAAI,GAAG,IAAI;EACf,IAAIC,KAAK,GAAGC,UAAU,CAAC,YAAW;IAChCF,IAAI,CAACnB,SAAS,EAAE;IAEhB,IAAImB,IAAI,CAACjB,mBAAmB,EAAE;MAC5BiB,IAAI,CAAChB,QAAQ,GAAGkB,UAAU,CAAC,YAAW;QACpCF,IAAI,CAACjB,mBAAmB,CAACiB,IAAI,CAACnB,SAAS,CAAC;MAC1C,CAAC,EAAEmB,IAAI,CAAClB,iBAAiB,CAAC;MAE1B,IAAI,IAAI,CAACJ,QAAQ,CAACyB,KAAK,EAAE;QACrBH,IAAI,CAAChB,QAAQ,CAACmB,KAAK,CAAC,CAAC;MACzB;IACF;IAEAH,IAAI,CAACrB,GAAG,CAACqB,IAAI,CAACnB,SAAS,CAAC;EAC1B,CAAC,EAAEc,OAAO,CAAC;EAEX,IAAI,IAAI,CAACjB,QAAQ,CAACyB,KAAK,EAAE;IACrBF,KAAK,CAACE,KAAK,CAAC,CAAC;EACjB;EAEA,OAAO,IAAI;AACb,CAAC;AAED9B,cAAc,CAACgB,SAAS,CAACe,OAAO,GAAG,UAASC,EAAE,EAAEC,UAAU,EAAE;EAC1D,IAAI,CAAC3B,GAAG,GAAG0B,EAAE;EAEb,IAAIC,UAAU,EAAE;IACd,IAAIA,UAAU,CAACX,OAAO,EAAE;MACtB,IAAI,CAACb,iBAAiB,GAAGwB,UAAU,CAACX,OAAO;IAC7C;IACA,IAAIW,UAAU,CAACC,EAAE,EAAE;MACjB,IAAI,CAACxB,mBAAmB,GAAGuB,UAAU,CAACC,EAAE;IAC1C;EACF;EAEA,IAAIP,IAAI,GAAG,IAAI;EACf,IAAI,IAAI,CAACjB,mBAAmB,EAAE;IAC5B,IAAI,CAACC,QAAQ,GAAGkB,UAAU,CAAC,YAAW;MACpCF,IAAI,CAACjB,mBAAmB,CAAC,CAAC;IAC5B,CAAC,EAAEiB,IAAI,CAAClB,iBAAiB,CAAC;EAC5B;EAEA,IAAI,CAACH,GAAG,CAAC,IAAI,CAACE,SAAS,CAAC;AAC1B,CAAC;AAEDR,cAAc,CAACgB,SAAS,CAACmB,GAAG,GAAG,UAASH,EAAE,EAAE;EAC1CI,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC;EACvD,IAAI,CAACN,OAAO,CAACC,EAAE,CAAC;AAClB,CAAC;AAEDhC,cAAc,CAACgB,SAAS,CAACsB,KAAK,GAAG,UAASN,EAAE,EAAE;EAC5CI,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;EACzD,IAAI,CAACN,OAAO,CAACC,EAAE,CAAC;AAClB,CAAC;AAEDhC,cAAc,CAACgB,SAAS,CAACsB,KAAK,GAAGtC,cAAc,CAACgB,SAAS,CAACmB,GAAG;AAE7DnC,cAAc,CAACgB,SAAS,CAACuB,MAAM,GAAG,YAAW;EAC3C,OAAO,IAAI,CAAChC,OAAO;AACrB,CAAC;AAEDP,cAAc,CAACgB,SAAS,CAACwB,QAAQ,GAAG,YAAW;EAC7C,OAAO,IAAI,CAAChC,SAAS;AACvB,CAAC;AAEDR,cAAc,CAACgB,SAAS,CAACyB,SAAS,GAAG,YAAW;EAC9C,IAAI,IAAI,CAAClC,OAAO,CAACmB,MAAM,KAAK,CAAC,EAAE;IAC7B,OAAO,IAAI;EACb;EAEA,IAAIgB,MAAM,GAAG,CAAC,CAAC;EACf,IAAID,SAAS,GAAG,IAAI;EACpB,IAAIE,cAAc,GAAG,CAAC;EAEtB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACrC,OAAO,CAACmB,MAAM,EAAEkB,CAAC,EAAE,EAAE;IAC5C,IAAIC,KAAK,GAAG,IAAI,CAACtC,OAAO,CAACqC,CAAC,CAAC;IAC3B,IAAIE,OAAO,GAAGD,KAAK,CAACC,OAAO;IAC3B,IAAIC,KAAK,GAAG,CAACL,MAAM,CAACI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;IAEtCJ,MAAM,CAACI,OAAO,CAAC,GAAGC,KAAK;IAEvB,IAAIA,KAAK,IAAIJ,cAAc,EAAE;MAC3BF,SAAS,GAAGI,KAAK;MACjBF,cAAc,GAAGI,KAAK;IACxB;EACF;EAEA,OAAON,SAAS;AAClB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}