import RadixECIES from '../crypto/RadixECIES';
import RadixIdentity from './RadixIdentity';
export default class RadixSimpleIdentity extends RadixIdentity {
    constructor(address) {
        super(address);
        this.address = address;
    }
    async signAtom(atom) {
        const signature = this.address.sign(atom.getHash());
        const signatureId = this.address.getUID();
        atom.signatures = { [signatureId.toString()]: signature };
        return atom;
    }
    async decryptECIESPayload(payload) {
        return RadixECIES.decrypt(this.address.getPrivate(), payload);
    }
    async decryptECIESPayloadWithProtectors(protectors, payload) {
        return RadixECIES.decryptWithProtectors(this.address.getPrivate(), protectors, payload);
    }
    getPublicKey() {
        return this.address.getPublic();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhTaW1wbGVJZGVudGl0eS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9tb2R1bGVzL2lkZW50aXR5L1JhZGl4U2ltcGxlSWRlbnRpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxVQUFVLE1BQU0sc0JBQXNCLENBQUE7QUFDN0MsT0FBTyxhQUFhLE1BQU0saUJBQWlCLENBQUE7QUFJM0MsTUFBTSxDQUFDLE9BQU8sT0FBTyxtQkFBb0IsU0FBUSxhQUFhO0lBQzFELFlBQXFCLE9BQXFCO1FBQ3RDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQURHLFlBQU8sR0FBUCxPQUFPLENBQWM7SUFFMUMsQ0FBQztJQUVNLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBZTtRQUNqQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtRQUNuRCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO1FBRXpDLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFBO1FBRXpELE9BQU8sSUFBSSxDQUFBO0lBQ2YsQ0FBQztJQUVNLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxPQUFlO1FBQzVDLE9BQU8sVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQ2pFLENBQUM7SUFFTSxLQUFLLENBQUMsaUNBQWlDLENBQUMsVUFBb0IsRUFBRSxPQUFlO1FBQ2hGLE9BQU8sVUFBVSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUUsVUFBVSxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQzNGLENBQUM7SUFFTSxZQUFZO1FBQ2YsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFBO0lBQ25DLENBQUM7Q0FDSiJ9